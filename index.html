<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hydrangea Cypher</title>

    <link rel="icon" href="./bread_128.ico">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link rel="stylesheet" href="./index.css">
</head>

<body>
    <div class="container mt-3 mb-3">

        <div class="mb-3">
            <h1>Hydrangea Cypher</h1>
            - Made by <a href="https://zeyu-xie.github.io/Acan">Acan</a>
        </div>

        <div class="form-check form-switch mb-3">
            <input class="form-check-input" type="checkbox" role="switch" id="encryptTypeSwitch" checked>
            <label class="form-check-label" for="encryptTypeSwitch">Encrypt Texts</label>
        </div>

        <section id="section1">
            <div class="input-group mb-3">
                <span class="input-group-text">Content</span>
                <textarea id="contentInput" class="form-control" aria-label="With textarea"></textarea>
            </div>

            <div class="input-group mb-3">
                <span class="input-group-text">Passphrase</span>
                <input id="passphraseInput" type="text" class="form-control" aria-label="passphrase"
                    aria-describedby="basic-addon1">
            </div>

            <div class="input-group mb-3">
                <button id="encryptButton" class="btn btn-outline-secondary" type="button">Encrypt</button>
                <button id="decryptButton" class="btn btn-outline-secondary" type="button">Decrypt</button>
                <button id="copyButton" class="btn btn-outline-secondary" type="button">Copy</button>
            </div>

            <div id="result" class="mb-5">
            </div>
        </section>

        <section id="section2" style="display: none;">
            <div class="input-group mb-3">
                <input type="file" class="form-control" id="fileUpload2">
                <label class="input-group-text" for="fileUpload2">Upload</label>
            </div>

            <div class="input-group mb-3">
                <span class="input-group-text">Passphrase</span>
                <input id="passphraseInput2" type="text" class="form-control" aria-label="passphrase"
                    aria-describedby="basic-addon1">
            </div>

            <div class="input-group mb-3">
                <button id="encryptButton2" class="btn btn-outline-secondary" type="button">Encrypt</button>
                <button id="decryptButton2" class="btn btn-outline-secondary" type="button">Decrypt</button>
            </div>

            <div id="result2" class="mb-5">
                <a href="" download="" id="downloadLink2">Download Link</a>
            </div>

        </section>

        <hr>

        <div class="mb-3">
            <ul>
                <li>
                    <b>2023.10.25</b>
                    <ul>
                        <li>
                            Allow users to encrypt files. However, due to unknown reasons, large files
                            may not be encrypted successfully so far.
                        </li>
                        <li>
                            We have fixed the bug from <code>uint8ToBase64</code> function, which originally led to
                            stack
                            overflow in case that files larger than 8 KB occurs.
                        </li>
                    </ul>
                </li>
                <li>
                    <b>2023.10.23</b>
                    <ul>
                        <li>
                            Deleted the static <code>encryptedContent.substring(0,10)</code> which is always
                            shown as <code>U2FsdGVkX1</code>. This string basically stands for the base64 form of the
                            UTF-8
                            string <code>Salted__</code>.
                        </li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>

    <div id="spinner" class="spinner-border text-secondary" role="status"
        style="display: none;">
        <span class="visually-hidden">Loading...</span>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
        crossorigin="anonymous"></script>
    <script src="./node_modules/crypto-js/crypto-js.js"></script>
    <script>
        const _encryptTypeSwitch = document.getElementById("encryptTypeSwitch")
        const _section1 = document.getElementById("section1")
        const _section2 = document.getElementById("section2")
        const _spinner = document.getElementById("spinner")
        _encryptTypeSwitch.addEventListener("change", () => {
            if (_encryptTypeSwitch.checked) {
                _section1.style.display = "block"
                _section2.style.display = "none"
            }
            else {
                _section1.style.display = "none"
                _section2.style.display = "block"
            }
        })
        const showSpinner = () => {
            _spinner.style.display = "block"
        }
        const hideSpinner = () => {
            _spinner.style.display = "none"
        }
    </script>
    <script src="./index.js"></script>
    <script src="./index2.js"></script>
</body>

</html>